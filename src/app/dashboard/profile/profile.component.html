<app-loading *ngIf="loading"></app-loading>

<mat-card *ngIf="!loading">
  <mat-card-content>
    <mat-card-title>Profile</mat-card-title>
    <form [formGroup]="form" (ngSubmit)="onSubmit()" style="display: block">
      <section class="outerContainer">
        <div fxLayout="row flex-layout">
          <div fxFlex.gt-xs="20" fxFlex="100">
            <mat-form-field appearance="fill">
              <mat-label>Title</mat-label>
              <mat-select [formControl]="TitleId" [errorStateMatcher]="matcher">
                <mat-option *ngFor="let titleOption of titles" [value]="titleOption.id">{{
                  titleOption.name
                }}</mat-option>
              </mat-select>
            </mat-form-field>
            <small *ngIf="TitleId.invalid && TitleId.touched" class="text-danger support-text">{{
              selectFieldError(TitleId)
            }}</small>
          </div>
        </div>

        <div fxLayout="row flex-layout" fxLayoutGap="20px">
          <div fxFlex.gt-sm="calc(33%-20px)" fxFlex="100">
            <mat-form-field>
              <input matInput placeholder="First Name" type="text" [formControl]="FirstName" />
            </mat-form-field>
            <small
              *ngIf="FirstName.invalid && FirstName.touched"
              class="text-danger support-text"
              >{{ textFieldError(FirstName) }}</small
            >
          </div>
          <div fxFlex.gt-sm="calc(33%-20px)" fxFlex="100">
            <mat-form-field>
              <input matInput placeholder="Middle Name" type="text" [formControl]="MiddleName" />
            </mat-form-field>
            <small
              *ngIf="MiddleName.invalid && MiddleName.touched"
              class="text-danger support-text"
              >{{ textFieldError(MiddleName) }}</small
            >
          </div>
          <div fxFlex.gt-sm="calc(33%-20px)" fxFlex="100">
            <mat-form-field>
              <input matInput placeholder="Surname" type="text" [formControl]="LastName" />
            </mat-form-field>
            <small *ngIf="LastName.invalid && LastName.touched" class="text-danger support-text">{{
              textFieldError(LastName)
            }}</small>
          </div>

          <div fxFlex="100">
            <mat-form-field>
              <input matInput placeholder="Known As" type="text" [formControl]="KnownAs" />
            </mat-form-field>
            <small *ngIf="KnownAs.invalid && KnownAs.touched" class="text-danger support-text">{{
              textFieldError(KnownAs)
            }}</small>
          </div>

          <div fxFlex="100">
            <mat-form-field>
              <input
                matInput
                placeholder="Unique Medical Record Number (UMRN)"
                type="text"
                [formControl]="UniqueMedicalRecordNumber"
              />
            </mat-form-field>
            <small
              *ngIf="UniqueMedicalRecordNumber.invalid && UniqueMedicalRecordNumber.touched"
              class="text-danger support-text"
              >{{ textFieldError(UniqueMedicalRecordNumber) }}</small
            >
          </div>

          <div fxFlex="100">
            <mat-form-field>
              <input matInput placeholder="Maiden Name" type="text" [formControl]="MaidenName" />
            </mat-form-field>
            <small
              *ngIf="MaidenName.invalid && MaidenName.touched"
              class="text-danger support-text"
              >{{ textFieldError(MaidenName) }}</small
            >
          </div>

          <div fxFlex="100">
            <mat-form-field appearance="fill">
              <mat-label>Marital Status</mat-label>
              <mat-select [formControl]="MaritalStatusId" [errorStateMatcher]="matcher">
                <mat-option
                  *ngFor="let maritalStatus of maritalStatuses"
                  [value]="maritalStatus.id"
                  >{{ maritalStatus.name }}</mat-option
                >
              </mat-select>
            </mat-form-field>
            <small
              *ngIf="MaritalStatusId.invalid && MaritalStatusId.touched"
              class="text-danger support-text"
              >{{ selectFieldError(MaritalStatusId) }}</small
            >
          </div>

          <div fxFlex="100">
            <mat-form-field>
              <input
                matInput
                [matDatepicker]="picker"
                placeholder="Date of Birth"
                [formControl]="DateOfBirth"
              />
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
            <small
              *ngIf="DateOfBirth.invalid && DateOfBirth.touched"
              class="text-danger support-text"
              >{{ dateOfBirthError }}</small
            >
          </div>

          <div fxFlex="100">
            <mat-form-field appearance="fill">
              <mat-label>Gender</mat-label>
              <mat-select [formControl]="Gender" [errorStateMatcher]="matcher">
                <mat-option *ngFor="let genderOption of genders" [value]="genderOption.id">{{
                  genderOption.name
                }}</mat-option>
              </mat-select>
            </mat-form-field>
            <small *ngIf="Gender.invalid && Gender.touched" class="text-danger support-text">{{
              textFieldError(Gender)
            }}</small>
          </div>

          <div fxFlex.gt-sm="calc(33%-20px)" fxFlex="100">
            <mat-form-field>
              <ngx-mat-intl-tel-input
                [preferredCountries]="['au', 'in', 'cn']"
                [enablePlaceholder]="true"
                [enableSearch]="true"
                name="HomePhone"
                describedBy="phoneInput"
                formControlName="HomePhone"
                placeholder="Home Phone"
              ></ngx-mat-intl-tel-input>
            </mat-form-field>
            <small *ngIf="HomePhone.invalid && HomePhone.touched" class="text-danger support-text">{{
              textFieldError(HomePhone)
            }}</small>
          </div>
          <div fxFlex.gt-sm="calc(33%-20px)" fxFlex="100">
            <mat-form-field>
              <ngx-mat-intl-tel-input
                [preferredCountries]="['au', 'in', 'cn']"
                [enablePlaceholder]="true"
                [enableSearch]="true"
                name="WorkPhone"
                describedBy="phoneInput"
                formControlName="WorkPhone"
                placeholder="Work Phone"
              ></ngx-mat-intl-tel-input>
            </mat-form-field>
            <small *ngIf="WorkPhone.invalid && WorkPhone.touched" class="text-danger support-text">{{
              textFieldError(WorkPhone)
            }}</small>
          </div>

          <div fxFlex.gt-sm="calc(33%-20px)" fxFlex="100">
            <mat-form-field>
              <ngx-mat-intl-tel-input
                [preferredCountries]="['au', 'in', 'cn']"
                [enablePlaceholder]="true"
                [enableSearch]="true"
                name="Mobile"
                describedBy="phoneInput"
                formControlName="Mobile"
                placeholder="Mobile *"
              ></ngx-mat-intl-tel-input>
            </mat-form-field>
            <small
            *ngIf="Mobile.invalid && Mobile.touched"
            class="text-danger support-text"
            >{{ textFieldError(Mobile) }}</small>
          </div>

          <div fxFlex="100">
            <mat-form-field>
              <input
                matInput
                placeholder="Address"
                type="text"
                (keyup)="search()"
                [formControl]="Address"
              />
            </mat-form-field>
            <small *ngIf="Address.invalid && Address.touched" class="text-danger support-text">{{
              textFieldError(Address)
            }}</small>
          </div>
          <div>
            <div
              *ngFor="let place of places"
              (click)="getPlace(place.placeId)"
              class="p-t-5 p-b-5 cursor-pointer"
            >
              {{ place.formattedAddress }}
            </div>
          </div>

          <div fxFlex="100">
            <mat-form-field>
              <input matInput placeholder="Address 2" type="text" [formControl]="AddressExtra" />
            </mat-form-field>
            <small
              *ngIf="AddressExtra.invalid && AddressExtra.touched"
              class="text-danger support-text"
              >{{ textFieldError(AddressExtra) }}</small
            >
          </div>

          <div fxFlex="100">
            <mat-form-field>
              <input matInput placeholder="Suburb" type="text" [formControl]="Suburb" />
            </mat-form-field>
            <small *ngIf="Suburb.invalid && Suburb.touched" class="text-danger support-text">{{
              textFieldError(Suburb)
            }}</small>
          </div>

          <div fxFlex="100">
            <mat-form-field>
              <input matInput placeholder="State" type="text" [formControl]="State" />
            </mat-form-field>
            <small *ngIf="State.invalid && State.touched" class="text-danger support-text">{{
              selectFieldError(State)
            }}</small>
          </div>

          <div fxFlex="100">
            <mat-form-field appearance="fill">
              <mat-label>Country</mat-label>
              <mat-select [formControl]="CountryId" [errorStateMatcher]="matcher">
                <mat-option *ngFor="let country of countries" [value]="country.id">{{
                  country.name
                }}</mat-option>
              </mat-select>
            </mat-form-field>
            <small
              *ngIf="CountryId.invalid && CountryId.touched"
              class="text-danger support-text"
              >{{ selectFieldError(CountryId) }}</small
            >
          </div>
          <div *ngIf="errors.length > 0" class="text-danger">
            <ul>
              <li *ngFor="let error of errors">
                {{ error }}
              </li>
            </ul>
          </div>

          <div fxFlex.gt-sm="100" fxFlex="100">
            <button mat-raised-button color="primary">Submit</button>
          </div>
        </div>
      </section>
    </form>
  </mat-card-content>
</mat-card>
